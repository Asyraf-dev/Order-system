<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Queue Status</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.4.0/dist/confetti.browser.min.js"></script>
  <style>
  :root {
    --primary-bg: #ffffff;
    --secondary-bg: #f4f4f4;
    --primary-text: #222;
    --light-text: #666;
    --border-radius: 16px;

    --new-order: #2980b9;
    --preparing: #e67e22;
    --ready: #27ae60;
  }

  body {
    font-family: 'Poppins', sans-serif;
    margin: 0;
    padding: 0;
    background-color: var(--secondary-bg);
    color: var(--primary-text);
    animation: fadeInBody 1s ease-in;
  }

  @keyframes fadeInBody {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  .container {
    max-width: 1000px;
    margin: 60px auto;
    padding: 40px;
    background: var(--primary-bg);
    border-radius: var(--border-radius);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
    animation: fadeInUp 1s ease forwards;
  }

  @keyframes fadeInUp {
    from {
      transform: translateY(30px);
      opacity: 0;
    }
    to {
      transform: translateY(0);
      opacity: 1;
    }
  }

  .header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    flex-wrap: wrap;
    margin-bottom: 35px;
  }

  .logo {
    width: 140px;
  }

  .restaurant-name {
    font-size: 26px;
    font-weight: 600;
    color: var(--primary-text);
  }

  #darkModeToggle {
    font-size: 20px;
    background: none;
    border: none;
    cursor: pointer;
    transition: color 0.3s;
  }

  .queue-boxes {
    display: flex;
    justify-content: space-between;
    flex-wrap: wrap;
    gap: 25px;
  }

  .queue-box {
    flex: 1;
    min-width: 280px;
    padding: 30px 25px;
    border-radius: 20px;
    text-align: center;
    font-weight: 600;
    color: white;
    backdrop-filter: blur(5px);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    animation: fadeInPop 1s ease forwards;
  }

  .queue-box:hover {
    transform: scale(1.03);
    box-shadow: 0 10px 28px rgba(0, 0, 0, 0.12);
  }

  @keyframes fadeInPop {
    from {
      opacity: 0;
      transform: scale(0.95);
    }
    to {
      opacity: 1;
      transform: scale(1);
    }
  }

  .queue-box h2 {
    font-size: 22px;
    margin-bottom: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
  }

  .queue-box p {
    font-size: 24px;
    font-weight: 500;
    letter-spacing: 1px;
    word-spacing: 4px;
  }

  .receiver {
    background: var(--new-order);
  }

  .preparing {
    background: var(--preparing);
  }

  .ready {
    background: var(--ready);
  }

  /* Pulse animation only for ready box for emphasis */
  .ready p {
    animation: pulseText 2s infinite;
  }

  @keyframes pulseText {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.7; }
  }

  footer {
    text-align: center;
    margin-top: 50px;
    padding: 20px;
    font-size: 0.9rem;
    background-color: #f9f9f9;
    color: var(--light-text);
    border-top: 1px solid #ddd;
  }

  footer a {
    color: #007bff;
    text-decoration: none;
    margin: 0 8px;
  }

  footer a:hover {
    text-decoration: underline;
  }

  @media (max-width: 768px) {
    .queue-boxes {
      flex-direction: column;
    }

    .container {
      padding: 25px 20px;
    }

    .restaurant-name {
      font-size: 22px;
      text-align: center;
      width: 100%;
    }

    .header {
      justify-content: center;
      gap: 15px;
    }
  }

  /* ========== Dark Mode ========== */
  .dark-mode {
    background-color: #1e1e1e;
    color: #eee;
  }

  .dark-mode .container {
    background: #2c2c2c;
    box-shadow: 0 8px 24px rgba(255, 255, 255, 0.05);
  }

  .dark-mode .queue-box {
    opacity: 0.95;
    box-shadow: 0 6px 18px rgba(255, 255, 255, 0.08);
  }

  .dark-mode footer {
    background-color: #121212;
    color: #ccc;
  }

  .dark-mode footer a {
    color: #4aa3ff;
  }

  /* ========== Wave Background (Optional) ========== */
  .wave-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 180px;
    background: url('https://www.svgviewer.dev/snapshot/99b9b98b-411b-4e33-8194-6ab3e415040b.svg') no-repeat center center;
    background-size: cover;
    z-index: -1;
    animation: waveAnimation 10s ease-in-out infinite;
    opacity: 0.1;
  }

  @keyframes waveAnimation {
    0% { transform: translateX(0); }
    100% { transform: translateX(-100%); }
  }
</style>

</head>
<body>
  <div class="wave-container"></div>
  
  <div class="container">
    <div class="header">
      <img src="logo.png" alt="Company Logo" class="logo" />
      <div class="restaurant-name">Order Monitoring <span style="color:#2ecc71;">[Live Update]</span></div>
      <button id="darkModeToggle" style="margin-left: auto;">ðŸŒ™</button>
    </div>

    <div class="queue-boxes">
      <div class="queue-box receiver">
        <h2><i class="fas fa-inbox"></i> New Orders</h2>
        <p id="receiverQueue">Loading...</p>
      </div>
      <div class="queue-box preparing">
        <h2><i class="fas fa-hourglass-half"></i> Preparing</h2>
        <p id="preparingQueue">Loading...</p>
      </div>
      <div class="queue-box ready">
        <h2><i class="fas fa-check-circle"></i> Ready</h2>
        <p id="readyQueue">Loading...</p>
      </div>
    </div>
  </div>

  <footer>
    <p><b>Little Ngences X Ayam Gepuk Ngences</b></p>
    <p>&copy; 2024 electricaltechnologymy. All rights reserved.</p>
    <p>
      <a href="https://wa.me/+60176977263">Contact Us</a> |
      <a href="https://www.instagram.com/littlengencescoffee?igsh=MWZhZmM4YXcyc2Fraw==" target="_blank">Instagram</a> |
      <a href="https://www.tiktok.com/@little.ngences.co?_t=8nzZDYmHXhg&_r=1" target="_blank">TikTok</a> |
      <a href="https://batugajahdev.wixstudio.io/little-ngences" target="_blank">Website</a>
    </p>
  </footer>

  <script>
  const firebaseConfig = {
    apiKey: "AIzaSyAUO2ZoVhSFEtAyJAP5r5zxu3kGqoIAyQ4",
    authDomain: "ordersystem-d710a.firebaseapp.com",
    databaseURL: "https://ordersystem-d710a-default-rtdb.asia-southeast1.firebasedatabase.app",
    projectId: "ordersystem-d710a",
    storageBucket: "ordersystem-d710a.appspot.com",
    messagingSenderId: "741444965493",
    appId: "1:741444965493:web:9991535a9105035c80943c"
  };

  firebase.initializeApp(firebaseConfig);
  const database = firebase.database();

  function updateQueueNumbers() {
  const ordersRef = database.ref("orders");

  ordersRef.on("value", (snapshot) => {
    if (snapshot.exists()) {
      const ordersData = snapshot.val();
      let preparingQueue = [];
      let readyQueue = [];
      let receiverQueue = [];

      Object.entries(ordersData).forEach(([orderId, order]) => {
        if (!order) return;

        let queueNumber = String(order.queueNumber || "").trim();
        if (
          !queueNumber ||
          ["n/a", "na", "unknown"].includes(queueNumber.toLowerCase())
        ) return;

        let status = (order.status || "").trim().toLowerCase();
        let foodStatus = (order.foodStatus || "").trim().toLowerCase();
        let drinkStatus = (order.drinkStatus || "").trim().toLowerCase();

        // âœ… READY: Both food and drink are ready
        if (foodStatus === "food ready" && drinkStatus === "drink ready") {
          if (!readyQueue.includes(queueNumber)) {
            readyQueue.push(queueNumber);
            confetti(); // ðŸŽ‰ trigger confetti once
          }
        }
        // ðŸŸ§ PREPARING: Either food or drink is preparing or ready (but not both ready)
        else if (
          foodStatus.includes("preparing") ||
          drinkStatus.includes("preparing") ||
          foodStatus === "food ready" ||
          drinkStatus === "drink ready"
        ) {
          preparingQueue.push(queueNumber);
        }
        // ðŸŸ¦ RECEIVED: Neither food nor drink started
        else if (status.includes("received")) {
          receiverQueue.push(queueNumber);
        }
      });

      // âœ… Update UI
      document.getElementById("receiverQueue").innerText =
        receiverQueue.length ? receiverQueue.join(", ") : "No orders";

      document.getElementById("preparingQueue").innerText =
        preparingQueue.length ? preparingQueue.join(", ") : "No orders";

      document.getElementById("readyQueue").innerText =
        readyQueue.length ? readyQueue.join(", ") : "No orders";

    } else {
      document.getElementById("receiverQueue").innerText = "No active orders";
      document.getElementById("preparingQueue").innerText = "No active orders";
      document.getElementById("readyQueue").innerText = "No active orders";
    }
  }, (error) => {
    console.error("Firebase read error:", error);
  });
}


  document.addEventListener("DOMContentLoaded", updateQueueNumbers);

  // Dark mode toggle
  document.getElementById('darkModeToggle').addEventListener('click', () => {
    document.body.classList.toggle('dark-mode');
  });
</script>

</body>
</html>
